# Configuration


## Arguments

* STRING path to a CONFIG yaml file. This is the repository analysis config.
* The driftool system config (SYSCONF). The ``driftool.yaml`` is not passed via a command-line argument but the driftool resolves the config by name. It must be located in the repository root (or volume folder for docker setup).

**If run via docker, the config files and the input repository must be located in the ``./volume`` directory. The path must be provided in local syntax ``./volume/config.yaml`` and ``./volume/repository``.** See the provided docker tutorial for more information.


## Sysconf Paramters

* ``number_threads`` INT the number of threads + 1 the driftool will use. To run the analysis on 4 threads, set this to 4. A fifth thread serves as an orchestrator. Each thread > 1 will occupy additional disk space. This space is as large as the analyzed repository.
* ``max_ram_gb`` The maximum number of GB RAM used by the tool. This must be at least ``repository_size * number_threads + repository_size``. We recommend to add at least 2 GB more to ensure a stable analysis.


## Config Parameters

* ``input_repository`` STRING absolute path to the input repository.
* ``output_directory`` STRING (optional) exports the analysis to a json file to the specified directory.
* ``fetch_updates``BOOLEAN pull each branch of the (local tmp) repository before analysis starts.
* ``print_plot`` BOOLEAN show a pyplot of the results after finishing the calculation.
* ``html`` BOOLEAN generate a static HTML page with interactive in-depth result analysis. Requires the ``output_directory`` to be set.
* ``show_html`` BOOLEAN automatically open the HTML analysis in the default browser after completing the calculation. Requires ``html`` to be enabled.
---
* ``branch_ignore`` STRING a list of regualar expressions (python style). Branch names matching at least one of the expressions are ignored. For example, ignore numbered release branches.
* ``file_ignore`` STRING files to be ignored during comparison. A list of regex expressions which are matched against the file path. Binaries or large autogenerated files should be ignored during analysis, e.g., ``\.pdf``, ``package-lock\.json`` or ``gradle\-wrapper\/``. This has no impact on directory structures.
* ``file_whitelist`` STRING files to be whitelisted during comparison. A list of regex expressions which are matched against the file path. This has no impact on directory structures.
* ``timeout`` INT (optional) specifies the number of days in which a branch must have received its last commit. Otherwise it will not be analyzed. A value <= 0 skips this check.
---
* ``report_title=` STRING (optional) renders a custom headline string into the generated HTML report. Long titles may result in bad formatting of the HTML.
* ``csv_file`` STRING (optional) DEVEVLOPER FEATURE Set a CSV distance matrix as input. This bypasses the repository analysis. Check the doc comments in the code for more information.
* ``simple_export`` BOOLEAN if set, a simple report consisting of a single txt file with the drift number is produces in addition to the full report.
  

## Config Examples

**Example**

```
python main.py ../my_config.yaml
```
#### Config

```YAML
input_repository: STRING
output_directory: STRING
fetch_updates: BOOLEAN
report_title: STRING
print_plot: BOOLEAN
html: BOOLEAN
show_html: BOOLEAN
simple_export: BOOLEAN
csv_file: STRING
timeout: 90
branch_ignore:
    - STRING
blacklist: 
    - STRING
whitelist:
    - STRING
```

**Example**

The following example is provided as ``config.template.yaml`` as part of this repository.

```YAML
input_repository: /Users/.../my-repository
output_directory: ../
fetch_updates: false
report_title: My Report
print_plot: false
html: true
show_html: true
simple_export: false
branch_ignore:
    - "^release\\-"
    - "^v\\."
blacklist: 
    - "build\\/"
    - "dist\\/"
    - "gen\\/"
    - "\\.min\\.js"
    - "\\.lib\\.js"
    - "node\\-modules\\/"
    - "\\.pdf"
    - "javadoc\\/"
    - "\\.png"
whitelist: []
```

**Whitelist Example**

The following example only analyses Java files and HTML templates adn ignores all other files.

```YAML
whitelist:
    - "\\.java"
    - "\\.template\\.html"
```
